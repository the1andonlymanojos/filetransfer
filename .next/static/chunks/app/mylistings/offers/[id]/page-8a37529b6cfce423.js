(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[630],{6117:function(e,s,t){Promise.resolve().then(t.bind(t,8596))},9108:function(e,s,t){"use strict";t.d(s,{Z:function(){return i}});/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let i=(0,t(7461).Z)("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]])},8596:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return g}});var i=t(7437),l=t(2265),n=t(7147),c=t(7907),a=t(3237),o=t(3929),r=t(575),d=t(9108);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let h=(0,t(7461).Z)("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);var u=t(2235),x=t(7290),f=t(5326),j=t(917),m=e=>{let{listingId:s}=e;(0,c.useRouter)();let[t,o]=(0,l.useState)(""),r="".concat(a.y,"api/questions/").concat(s);console.log(r);let[d,h]=(0,l.useState)([]);(0,n.pm)();let u=async e=>{let s=await fetch(r,{method:"GET",cache:"no-cache",headers:{"Content-Type":"application/json"}}),t=await s.json();200!==s.status&&(console.log("failed to fetch"),console.log(s.status),console.log(await s.json())),console.log(t),t.questions.length>0&&h(t.questions.filter(e=>0===e.answered))};return(0,l.useEffect)(()=>{u(s)},[]),(0,i.jsx)(i.Fragment,{children:(0,i.jsxs)("div",{className:"relative bg-white rounded-lg p-4 mb-1 w-full",children:[(0,i.jsx)("div",{className:"text-xl font-thin absolute top-2 left-7",children:"QnA"}),(0,i.jsx)("div",{className:"bg-white rounded-lg p-2 mb-1 mt-4 w-full max-h-[300px] overflow-y-scroll",children:(0,i.jsx)(j.Z,{withansbox:!0,setQ:o,questions:d})}),(0,i.jsx)("div",{className:"text-xs font-thin absolute bottom-1 left-4",children:"scroll for more"})]})})},g=e=>{let{params:s}=e;console.log(s.id);let t=Number.parseInt(s.id),j="".concat(a.y,"api/listings/offers/").concat(s.id),[g,p]=(0,l.useState)([]),[v,b]=(0,l.useState)(null),[y,w]=(0,l.useState)(!0),[N,k]=(0,l.useState)(!1),[C,O]=(0,l.useState)(!0),{toast:S}=(0,n.pm)(),z=(0,c.useRouter)(),T=(0,l.useRef)(null),_=async()=>{let e=await fetch(j,{method:"GET",cache:"no-cache",credentials:"include"});if(200!==e.status&&401!==e.status&&k(!0),401===e.status){O(!1),S({title:"Uh Oh!",description:"Looks like you are not logged in, please to check offers"}),z.push("/login?redirect=".concat(window.location.pathname));return}let s=await e.json();if(console.log(s),"available"!==s.listing.availability){let e=s.offers.find(e=>1===e.accepted);e&&z.push("/transactions/".concat(e.transaction_id));return}if(s.offers){for(let e of s.offers){let s=Date.parse(e.expires_at)-Date.now();console.log(s);let t=Math.floor(s/864e5),i=Math.floor(s%864e5/36e5)+24*t;i>0?e.timeLeft=i:e.timeLeft=-1}p(s.offers),w(!1),b(s.listing),console.log(g)}s.listing&&(b(s.listing),w(!1))};return(0,l.useEffect)(()=>{_()},[]),(0,i.jsx)("div",{className:"flex-row flex justify-center",children:(0,i.jsx)("div",{className:"max-w-md w-[100vw]",children:(0,i.jsxs)("div",{className:"",children:[(0,i.jsxs)("div",{className:"flex fex-row justify-start items-center",onClick:e=>{z.push("/mylistings")},children:[(0,i.jsx)(d.Z,{className:""}),(0,i.jsx)("h1",{className:"text-2xl p-2",children:"My Listings"})]}),(0,i.jsxs)("div",{className:"flex flex-row justify-start bg-gray-100 p-1 rounded-md shadow items-center",onClick:e=>{z.push("/listing/".concat(null==v?void 0:v.id))},children:[(0,i.jsx)("img",{src:"".concat(a.y)+(null==v?void 0:v.image_path),className:"w-24 h-24  object-cover rounded-2xl p-2  mr-2",alt:"thumbnail"}),(0,i.jsxs)("div",{className:"flex flex-row justify-between w-full",children:[(0,i.jsx)("div",{className:"text-xl",children:null==v?void 0:v.title}),(0,i.jsxs)("div",{className:"flex flex-row justify-end text-xs ",children:["Highest bid:",(0,i.jsx)("br",{}),(null==v?void 0:v.highest_bid)?v.highest_bid:"No offers yet"]})]})]}),(0,i.jsxs)(f.UQ,{type:"single",children:[(0,i.jsxs)(f.Qd,{value:"value-11",children:[(0,i.jsx)(f.o4,{children:" OFFERS: "}),(0,i.jsxs)(f.vF,{children:[(0,i.jsx)("div",{className:"m-2 text-lg",children:"Offers:"}),(0,i.jsxs)("div",{className:"m-2 text-base flex flex-col items-center justify-center",children:[0===g.length?(0,i.jsx)("div",{children:"No offers yet"}):null,y?(0,i.jsx)("div",{children:"Loading..."}):null]}),(0,i.jsx)("div",{children:g.map((e,s)=>(0,i.jsx)("div",{className:"w-full rounded-xl p-2 "+(null===e.accepted?"bg-gray-100":1===e.accepted?"bg-green-50":"bg-red-50"),children:(0,i.jsxs)("div",{className:"flex flex-row justify-between items-center flex-nowrap",children:[(0,i.jsxs)("h1",{children:[" Anonymous",(0,i.jsx)("br",{})," User"]}),(0,i.jsxs)("div",{className:"flex flex-col text-sm items-end",children:[(0,i.jsx)("div",{children:"Bid Amount"}),(0,i.jsxs)("div",{children:["₹",e.amount]})]}),(0,i.jsxs)("div",{className:"flex text-sm flex-col items-end",children:[(0,i.jsx)("div",{children:"Time Left"}),(0,i.jsx)("div",{children:e.timeLeft>0?e.timeLeft+" hours":"Expired"})]}),(0,i.jsx)("div",{children:(0,i.jsxs)("div",{className:"flex flex-col mr-3 justify-center items-center",children:[(0,i.jsxs)(o.dy,{children:[(0,i.jsx)(o.Qz,{asChild:!0,children:(0,i.jsx)(r.z,{variant:"outline",size:"icon",className:"h-8 w-8 bg-green-300 shrink-0 rounded-full",disabled:null!==e.accepted,children:(0,i.jsx)(h,{})})}),(0,i.jsx)(o.sc,{children:(0,i.jsxs)("div",{className:"mx-auto w-full max-w-sm",children:[(0,i.jsxs)(o.OX,{children:[(0,i.jsx)(o.iI,{children:"Are you absolutely sure?"}),(0,i.jsxs)(o.u6,{children:["This action cannot be undone. By clicking accept you agree to the bid of ₹",e.amount,". Failure to blah blah blah boilerplate"]})]}),(0,i.jsxs)(o.ze,{children:[(0,i.jsx)(r.z,{className:"bg-green-800",onClick:async s=>{let t="".concat(a.y,"api/offers/respond/").concat(e.id),l=await fetch(t,{method:"POST",cache:"no-cache",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({response:"accept"})}),n=await l.json();console.log(n),console.log("here"),200!==l.status?S({title:"Uh Oh!",variant:"destructive",description:"Failed to accept bid "+n.message}):(S({title:"Success",description:"Bid accepted",action:(0,i.jsx)(x.gD,{altText:"go to transaction page",onClick:()=>{console.log("going to transaction page")},children:"Open Transaction Page"})}),z.push("/transactions/".concat(n.transaction_id))),T.current.click()},children:"Accept Bid"}),(0,i.jsx)(o.uh,{asChild:!0,children:(0,i.jsx)(r.z,{ref:T,variant:"outline",children:"Cancel"})})]})]})})]}),(0,i.jsxs)(o.dy,{children:[(0,i.jsx)(o.Qz,{asChild:!0,children:(0,i.jsx)(r.z,{variant:"outline",size:"icon",className:"h-8 w-8 bg-red-300 shrink-0 rounded-full",disabled:null!==e.accepted,children:(0,i.jsx)(u.Z,{strokeWidth:1.25})})}),(0,i.jsx)(o.sc,{children:(0,i.jsxs)("div",{className:"mx-auto w-full max-w-sm",children:[(0,i.jsxs)(o.OX,{children:[(0,i.jsx)(o.iI,{children:"Are you absolutely sure?"}),(0,i.jsxs)(o.u6,{children:["This action cannot be undone. By clicking reject you are rejecting the bid of ₹",e.amount,". Failure to blah blah blah boilerplate"]})]}),(0,i.jsxs)(o.ze,{children:[(0,i.jsx)(r.z,{className:"bg-red-800",onClick:async s=>{let t="".concat(a.y,"api/offers/respond/").concat(e.id),i=await fetch(t,{method:"POST",cache:"no-cache",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({response:"reject"})}),l=await i.json();console.log(l),console.log("here"),200!==i.status?S({title:"Uh Oh!",variant:"destructive",description:"Failed to reject bid "+l.message}):S({title:"Success",description:"Bid rejected"}),T.current.click()},children:"Reject Bid"}),(0,i.jsx)(o.uh,{asChild:!0,children:(0,i.jsx)(r.z,{ref:T,variant:"outline",children:"Cancel"})})]})]})})]})]})})]})},e.id))})]})]}),(0,i.jsxs)(f.Qd,{value:"value-12",children:[(0,i.jsx)(f.o4,{children:"Unanswered Questions"}),(0,i.jsx)(f.vF,{children:(0,i.jsx)(m,{listingId:t})})]})]})]})})})}}},function(e){e.O(0,[614,791,484,859,971,69,744],function(){return e(e.s=6117)}),_N_E=e.O()}]);